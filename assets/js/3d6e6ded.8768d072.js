"use strict";(self.webpackChunkve_ps=self.webpackChunkve_ps||[]).push([[7756],{4137:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var a=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=a.createContext({}),c=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,s=e.originalType,i=e.parentName,d=r(e,["components","mdxType","originalType","parentName"]),p=c(n),m=o,g=p["".concat(i,".").concat(m)]||p[m]||u[m]||s;return n?a.createElement(g,l(l({ref:t},d),{},{components:n})):a.createElement(g,l({ref:t},d))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=n.length,l=new Array(s);l[0]=p;var r={};for(var i in t)hasOwnProperty.call(t,i)&&(r[i]=t[i]);r.originalType=e,r.mdxType="string"==typeof e?e:o,l[1]=r;for(var c=2;c<s;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},2955:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var a=n(7462),o=(n(7294),n(4137));const s={sidebar_position:1,description:"Setting up Wallet Account"},l="Setting up Wallet Account",r={unversionedId:"build/development-guides/using-ever-sdk-and-devtools-to-work-with-venom/setting-up-wallet-account",id:"build/development-guides/using-ever-sdk-and-devtools-to-work-with-venom/setting-up-wallet-account",title:"Setting up Wallet Account",description:"Setting up Wallet Account",source:"@site/docs/build/development-guides/using-ever-sdk-and-devtools-to-work-with-venom/setting-up-wallet-account.md",sourceDirName:"build/development-guides/using-ever-sdk-and-devtools-to-work-with-venom",slug:"/build/development-guides/using-ever-sdk-and-devtools-to-work-with-venom/setting-up-wallet-account",permalink:"/build/development-guides/using-ever-sdk-and-devtools-to-work-with-venom/setting-up-wallet-account",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,description:"Setting up Wallet Account"},sidebar:"buildSidebar",previous:{title:"Welcome",permalink:"/build/development-guides/using-ever-sdk-and-devtools-to-work-with-venom/"},next:{title:"Sending transactions in Venom",permalink:"/build/development-guides/using-ever-sdk-and-devtools-to-work-with-venom/sending-transactions"}},i={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Using CLI tool",id:"using-cli-tool",level:2},{value:"1. Install Everdev",id:"1-install-everdev",level:3},{value:"2. Configure network connection",id:"2-configure-network-connection",level:3},{value:"3. Set a giver contract on your network",id:"3-set-a-giver-contract-on-your-network",level:3},{value:"4. Get wallet account contract files",id:"4-get-wallet-account-contract-files",level:3},{value:"5. Create wallet account signer",id:"5-create-wallet-account-signer",level:3},{value:"6. Deploy the wallet account contract to blockchain",id:"6-deploy-the-wallet-account-contract-to-blockchain",level:3},{value:"Using SDK",id:"using-sdk",level:2},{value:"Multisig Wallet",id:"multisig-wallet",level:3},{value:"Ever Wallet",id:"ever-wallet",level:3},{value:"What&#39;s next?",id:"whats-next",level:2}],d={toc:c};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"setting-up-wallet-account"},"Setting up Wallet Account"),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"This guide will help you learn to set up wallet accounts in Venom Blockchain with EVER SDK and Everdev CLI tools. It is applicable both for contract development and testing tasks, and for the purposes of Venom integration to the backend of your applications."),(0,o.kt)("p",null,"SDK and Everdev CLI tool approaches are detailed below. They implement a similar process of wallet deployment."),(0,o.kt)("p",null,"Currently we can recommend the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/EverSurf/multisig2"},(0,o.kt)("strong",{parentName:"a"},"SetcodeMultisig"))," contract to be used for wallets. It is well tested and secure, supports multiple custodians, and can be set up to require several independent signatures for any transfers."),(0,o.kt)("p",null,"Alternatively, you may use the ",(0,o.kt)("strong",{parentName:"p"},"Ever Wallet")," contract. It has some different features and capabilities. You can read about them and find the contract files in this ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/broxus/ever-wallet-contract"},"repository"),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": Ever Wallet however is not currently supported by Everdev CLI tool, so only the SDK approach will work for it. If you choose it, skip straight to the ",(0,o.kt)("a",{parentName:"p",href:"#ever-wallet"},"SDK section with Ever Wallet sample"),". "),(0,o.kt)("h2",{id:"using-cli-tool"},"Using CLI tool"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://docs.everos.dev/everdev/"},"Everdev"),", the command line tool for development on the TVM blockchains, allows to write scripts to deploy any smart contracts to the blockchain, call all contract methods, sign transactions, and generally manage an account."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Note"),": This section is only applicable for Multisig Wallet. Refer to the ",(0,o.kt)("a",{parentName:"p",href:"#ever-wallet"},"SDK section")," for Ever Wallet guidelines.")),(0,o.kt)("h3",{id:"1-install-everdev"},"1. Install Everdev"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"$ npm install -g everdev\n")),(0,o.kt)("p",null,"It requires ",(0,o.kt)("a",{parentName:"p",href:"https://docs.npmjs.com/downloading-and-installing-node-js-and-npm"},"NPM")," to be installed."),(0,o.kt)("p",null,"If you experience any problems with installation, check out our ",(0,o.kt)("a",{parentName:"p",href:"https://docs.everos.dev/everdev/troubleshooting"},"troubleshooting")," section."),(0,o.kt)("h3",{id:"2-configure-network-connection"},"2. Configure network connection"),(0,o.kt)("p",null,"Everdev has a built-in ",(0,o.kt)("a",{parentName:"p",href:"https://docs.everos.dev/everdev/command-line-interface/network-tool"},"network")," tool to manage your networks and access credentials."),(0,o.kt)("p",null,"Add Venom endpoint to everdev and make it default:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"everdev network add venom https://gql-testnet.venom.foundation/\neverdev network default venom\n")),(0,o.kt)("h3",{id:"3-set-a-giver-contract-on-your-network"},"3. Set a giver contract on your network"),(0,o.kt)("p",null,"On Venom, you need to sponsor a contract address in advance to be able to deploy the contract."),(0,o.kt)("p",null,"Everdev provides a way to set an account of your choice as a giver for deployment operations, so you will not have to do a separate step of sending tokens to a new contract address every time you deploy something. This contract can be some multisig wallet, for example your ",(0,o.kt)("a",{parentName:"p",href:"https://venomwallet.com/"},"Venom Wallet"),"."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": To work automatically, the giver contract should have only one custodian."),(0,o.kt)("p",null,"To set it up, first save the custodian keys of your giver account into a signer that will be used to sign giver transactions (Learn more about the signer tool ",(0,o.kt)("a",{parentName:"p",href:"https://docs.everos.dev/everdev/command-line-interface/signer-tool"},"here"),"):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"everdev signer add giver_sign signer_secret_key_or_seed_phrase_in_quotes\n")),(0,o.kt)("p",null,"Then add the giver address specifying the signer to be used with it."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"everdev network giver venom giver_address --signer giver_sign --type MsigV2\n")),(0,o.kt)("p",null,"Where"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"giver_type")," is the type of the giver contract you selected (GiverV1 | GiverV2 | GiverV3 | SafeMultisigWallet | MsigV2| SetcodeMultisigWallet). MsigV2 is supported in the Venom wallet."),(0,o.kt)("h3",{id:"4-get-wallet-account-contract-files"},"4. Get wallet account contract files"),(0,o.kt)("p",null,"We recommend using",(0,o.kt)("a",{parentName:"p",href:"https://github.com/EverSurf/multisig2"}," Multisig 2.0")," contracts as a wallet. They can be found ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/EverSurf/multisig2"},"here"),". In this guide SetcodeMultisig specifically is used."),(0,o.kt)("p",null,"Download the contract files and place them in the working folder. Direct links to its files are as follows:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},".tvc")," - Compiled contract code"),(0,o.kt)("p",null,"SetcodeMultisig.tvc direct link:"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/EverSurf/multisig2/raw/main/build/SetcodeMultisig.tvc"},"https://github.com/EverSurf/multisig2/raw/main/build/SetcodeMultisig.tvc")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},".abi.json")," - application binary interface, describing the functions of the contract"),(0,o.kt)("p",null,"SetcodeMultisig.abi.json direct link:"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://raw.githubusercontent.com/EverSurf/multisig2/main/build/SetcodeMultisig.abi.json"},"https://raw.githubusercontent.com/EverSurf/multisig2/main/build/SetcodeMultisig.abi.json")),(0,o.kt)("p",null,"Execute the commands of the following steps from the directory with the contract files."),(0,o.kt)("h3",{id:"5-create-wallet-account-signer"},"5. Create wallet account signer"),(0,o.kt)("p",null,"To generate your wallet account signer enter the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"everdev signer generate wallet_signer\n")),(0,o.kt)("p",null,"Or, if you already have a seed phrase, add it like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'everdev signer add wallet_signer "your-seed-phrase-here"\n')),(0,o.kt)("p",null,"To deploy multisig wallet account you will need to specify the public key of the signer. To view it, use the following command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"everdev signer info wallet_signer\n")),(0,o.kt)("p",null,"The keys will be displayed in terminal (if you imported the seed phrase, it will be displayed here as well):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'{\n    "name": "wallet_signer",\n    "description": "",\n    "keys": {\n        "public": "8f8779e7c1944b133a423df96d06ae770c996f19d63438dbf2f569a29529b248",\n        "secret": "ce57d2666d0d2c737a03ca4e6cfa38c5ca088dbcef43eb0353896feca8aea2a5"\n    }\n}\n\n')),(0,o.kt)("p",null,"Usually a single owner (with a single signer) per wallet account is optimal for any tasks that require automation. However, it is possible to set up accounts with multiple owners. In this case, each of the owners has to generate their own signer and provide their public keys to the deployer. Also, the signer used to deploy the account doesn't have to be among its owners."),(0,o.kt)("h3",{id:"6-deploy-the-wallet-account-contract-to-blockchain"},"6. Deploy the wallet account contract to blockchain"),(0,o.kt)("p",null,"Use the following command for a simple one-owner account:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"everdev contract deploy SetcodeMultisig.abi.json constructor --signer wallet_signer --input owners:[<owner_public_key>],reqConfirms:1,lifetime:3600 --value 1000000000\n")),(0,o.kt)("p",null,"Where"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"value")," parameter is the amount of nanotokens to be spent on deployment (can be omitted, in which case 10 tokens from giver will be spent)"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"owner_public_key")," is usually the public key of ",(0,o.kt)("inlineCode",{parentName:"p"},"wallet_signer")," in the form ",(0,o.kt)("inlineCode",{parentName:"p"},"0x..."),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"lifetime")," - time in seconds that a transaction in multi-owner accounts will persist and be available for signing by other owners. For a simple multi owner account may be set to any value, as it will be executed immediately anyway."),(0,o.kt)("p",null,"Example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"everdev contract deploy SetcodeMultisig.abi.json constructor --signer wallet_signer --input owners:[0x8f8779e7c1944b133a423df96d06ae770c996f19d63438dbf2f569a29529b248],reqConfirms:1,lifetime:3600 --value 1000000000\n")),(0,o.kt)("p",null,"For more complex cases (multiple owners etc.) view Everdev contract tool ",(0,o.kt)("a",{parentName:"p",href:"https://docs.everos.dev/everdev/command-line-interface/contract-management"},"docs"),"."),(0,o.kt)("p",null,"Once the contract is deployed, its address will be displayed in terminal."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},'everdev contract deploy SetcodeMultisig.abi.json constructor --signer wallet_signer --input owners:[0x3da1909b7a4bd11fd9a1d79ca9713a9a8645880e0a7a12f9691c68e95d56fe75],reqConfirms:1,lifetime:3600 --value 10000000000\n\nConfiguration\n\n  Network: venom (https://gql-testnet.venom.foundation/)\n  Signer:  wallet_signer (public 8f8779e7c1944b133a423df96d06ae770c996f19d63438dbf2f569a29529b248)\n\nAddress:   0:95c35b94e98c1b5c7716a9129ed5bb0798c8c336465fd8d1eb0d385e3d969494 (calculated from TVC and signer public)\n\nParameters of constructor:\n\n  owners (uint256[]): ["0x3da1909b7a4bd11fd9a1d79ca9713a9a8645880e0a7a12f9691c68e95d56fe75"]\n  reqConfirms (uint8): "1"\n  lifetime (uint32): "3600"\n\nDeploying...\nContract is deployed at address: 0:95c35b94e98c1b5c7716a9129ed5bb0798c8c336465fd8d1eb0d385e3d969494\n\n')),(0,o.kt)("h2",{id:"using-sdk"},"Using SDK"),(0,o.kt)("p",null,"You may integrate above described process of wallet account deployment into your backend code. The functionality is supported in SDK."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("a",{parentName:"p",href:"https://docs.everos.dev/ever-sdk/#community-bindings"},"Bindings")," for a large number of languages have been developed for SDK.")),(0,o.kt)("h3",{id:"multisig-wallet"},"Multisig Wallet"),(0,o.kt)("p",null,"A sample is available in ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tonlabs/sdk-samples/tree/master/demo/msig-wallet"},"this repository")," and an overview is given below."),(0,o.kt)("p",null,"To run the sample, clone the repository, save the Venom endpoit as an environment variable and launch:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"export ENDPOINT=https://gql-testnet.venom.foundation/graphql\nnpm i\nnpm run msig-wallet\n")),(0,o.kt)("p",null,"Note, that similar to the Everdev approach described above, you have to sponsor a user account before deploying contract code. The sample assumes you send test tokens to the contract address generated by the sample. In a production environment you may set up a giver to sponsor your contract deployment operations. An example of such a set up can be found in this ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tonlabs/sdk-samples/tree/master/demo/hello-wallet"},"sample"),"."),(0,o.kt)("p",null,"The recommended ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tonlabs/sdk-samples/blob/master/demo/msig-wallet/contract/SetcodeMultisig.sol"},"SetcodeMultisig")," contract is used."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"    // 1. ------------------ Deploy multisig wallet --------------------------------\n    // \n    // Generate a key pair for the wallet to be deployed\n    const keypair = await client.crypto.generate_random_sign_keys();\n\n    // TODO: Save generated keypair!\n    console.log('Generated wallet keys:', JSON.stringify(keypair))\n    console.log('Do not forget to save the keys!')\n\n\n    const msigABI: string =\n        readFileSync(path.resolve(__dirname, \"../contract/SetcodeMultisig.abi.json\")).toString(\"utf8\")\n\n        const msigCode: string =\n        readFileSync(path.resolve(__dirname, \"../contract/SetcodeMultisig.code.boc\")).toString(\"base64\")\n\n    // We need to know the future address of the wallet account,\n    // because its balance must be positive for the contract to be deployed\n    //\n    // Future address can be calculated from code and data of the contract\n    //\n    // For solidity contracts of version up to ***\n    // initial data consists of pubkey + all static contract variables\n    // and can be packed like this:\n\n    const initData = (await client.abi.encode_boc({\n        params: [\n            { name: \"data\", type: \"map(uint64,uint256)\" }\n        ],\n        data: {\n            \"data\": {\n                0: `0x`+keypair.public\n            //  1: 1st-static-variable-value\n            //  2: 2nd-static-variable-value\n            },\n        }\n    })).boc;\n\n    console.log('Init data', initData);\n\n    // Lets construct the initial state of the contract\n    const stateInit = (await client.boc.encode_state_init({\n        code:msigCode,\n        data:initData\n    })).state_init;\n\n    // Address is the TVM hash of the initial state + workchain id (we work in 0 workchain)\n    const msigAddress = `0:`+(await client.boc.get_boc_hash({boc: stateInit})).hash;\n    console.log('Address: ', msigAddress);\n\n\n    console.log(`You can topup your wallet from dashboard at https://dashboard.evercloud.dev`)\n    console.log(`Please send >= ${MINIMAL_BALANCE} tokens to ${msigAddress}`)\n    console.log(`awaiting...`)\n\n    // Blocking here, waiting for account balance changes.\n    // It is assumed that at this time you go to dashboard.evercloud.dev\n    // and replenish this account.\n    let balance: number\n    let accType: number\n    for (; ;) {\n        // The idiomatic way to send a request is to specify \n        // query and variables as separate properties.\n        const getInfoQuery = `\n                query getBalance($address: String!) {\n                    blockchain {\n                    account(address: $address) {\n                            info {\n                            balance\n                            acc_type\n                        }\n                    }\n                }\n            }\n            `\n        const resultOfQuery: ResultOfQuery = await client.net.query({\n            query: getInfoQuery,\n            variables: { address: msigAddress }\n        });\n        const accountInfo = resultOfQuery.result.data.blockchain.account.info;\n\n\n        const nanotokens = parseInt(accountInfo.balance, 16)\n        accType = accountInfo.acc_type;\n        if (nanotokens >= MINIMAL_BALANCE * 1e9) {\n            balance = nanotokens / 1e9\n            break\n        }\n        // TODO: rate limiting\n        await sleep(1000)\n    }\n    console.log(`Account balance is: ${balance.toString(10)} tokens. Account type is ${accType}`)\n\n    console.log(`Deploying wallet contract to address: ${msigAddress} and waiting for transaction...`)\n\n    // Encode the body with constructor call\n    let body = (await client.abi.encode_message_body({\n        address: msigAddress,\n        abi: { type: 'Json', value: msigABI },\n        call_set: {       \n            function_name: 'constructor',\n            input: {\n                owners: [`0x${keypair.public}`],\n                reqConfirms: 1,\n                lifetime: 3600 \n            }\n        },\n        is_internal:false,\n        signer:{type: 'Keys', keys: keypair}\n    })).body;\n\n    let deployMsg =  await client.boc.encode_external_in_message({\n        dst: msigAddress,\n        init: stateInit,\n        body: body\n    });\n\n    let sendRequestResult = await client.processing.send_message({\n        message: deployMsg.message,\n        send_events: false\n    });\n\n    let transaction = (await client.processing.wait_for_transaction({\n        abi: { type: 'Json', value: msigABI },\n        message: deployMsg.message,\n        shard_block_id: sendRequestResult.shard_block_id,\n        send_events: false\n    })).transaction;\n\n    console.log('Contract deployed. Transaction hash', transaction?.id)\n    assert.equal(transaction?.status, 3)\n    assert.equal(transaction?.status_name, \"finalized\")\n\n")),(0,o.kt)("h3",{id:"ever-wallet"},"Ever Wallet"),(0,o.kt)("p",null,"A sample is available in ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tonlabs/sdk-samples/tree/master/demo/ever-wallet"},"this repository")," and an overview is given below."),(0,o.kt)("p",null,"To run the sample, clone the repository, save the Venom endpoit as an environment variable and launch:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"export ENDPOINT=https://gql-testnet.venom.foundation/graphql\nnpm i\nnpm run ever-wallet\n")),(0,o.kt)("p",null,"Note, that similar to the Everdev approach described above, you have to sponsor a user account before deploying contract code. The sample assumes you send test tokens to the contract address generated by the sample. In a production environment you may set up a giver to sponsor your contract deployment operations. An example of such a set up can be found in this ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/tonlabs/sdk-samples/tree/master/demo/hello-wallet"},"sample"),"."),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/broxus/ever-wallet-contract"},"Ever Wallet")," contract is used."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-typescript"},"    // 1. ------------------ Deploy ever-wallet --------------------------------\n    // \n    // Generate a key pair for the wallet to be deployed\n    const keypair = await client.crypto.generate_random_sign_keys();\n\n    // TODO: Save generated keypair!\n    console.log('Generated wallet keys:', JSON.stringify(keypair))\n    console.log('Do not forget to save the keys!')\n\n    // To deploy a wallet we need its code and ABI files\n    const everWalletCode: string =\n        readFileSync(path.resolve(__dirname, \"../contract/Wallet.code.boc\")).toString(\"base64\")\n    const everWalletABI: string =\n        readFileSync(path.resolve(__dirname, \"../contract/everWallet.abi.json\")).toString(\"utf8\")\n\n        const initData = (await client.abi.encode_boc({\n            params: [\n                { name: \"publicKey\", type: \"uint256\" },\n                { name: \"timestamp\", type: \"uint64\" }\n            ],\n            data: {\n                \"publicKey\": `0x`+keypair.public,\n                \"timestamp\": 0\n            }\n        })).boc;\n\n        console.log('Init data', initData);\n    \n\n    const stateInit = (await client.boc.encode_state_init({\n        code:everWalletCode,\n        data:initData\n    })).state_init;\n\n    const everWalletAddress = `0:`+(await client.boc.get_boc_hash({boc: stateInit})).hash;\n    console.log('Address: ', everWalletAddress);\n\n\n\n    console.log(`You can topup your wallet from dashboard at https://dashboard.evercloud.dev`)\n    console.log(`Please send >= ${MINIMAL_BALANCE} tokens to ${everWalletAddress}`)\n    console.log(`awaiting...`)\n\n    // Blocking here, waiting for account balance changes.\n    // It is assumed that at this time you go to dashboard.evercloud.dev\n    // and replenish this account.\n    let balance: number\n    for (; ;) {\n        // The idiomatic way to send a request is to specify \n        // query and variables as separate properties.\n        const getBalanceQuery = `\n                query getBalance($address: String!) {\n                    blockchain {\n                    account(address: $address) {\n                            info {\n                            balance\n                        }\n                    }\n                }\n            }\n            `\n        const resultOfQuery: ResultOfQuery = await client.net.query({\n            query: getBalanceQuery,\n            variables: { address: everWalletAddress }\n        })\n\n        const nanotokens = parseInt(resultOfQuery.result.data.blockchain.account.info?.balance, 16)\n        if (nanotokens >= MINIMAL_BALANCE * 1e9) {\n            balance = nanotokens / 1e9\n            break\n        }\n        // TODO: rate limiting\n        await sleep(1000)\n    }\n    console.log(`Account balance is: ${balance.toString(10)} tokens`)\n\n\n\n    console.log(`Making first transfer+deploy from ever-wallet contract to address: -1:7777777777777777777777777777777777777777777777777777777777777777 and waiting for transaction...`)\n// Here we construct body by ABI\n// and then add state init to the message for deploy\n  \n    let body = (await client.abi.encode_message_body({\n        address: everWalletAddress,\n        abi: { type: 'Json', value: everWalletABI },\n        call_set: {      \n            function_name: 'sendTransaction',\n            input: {\n                dest: '-1:7777777777777777777777777777777777777777777777777777777777777777',\n                value: '1000000000', // amount in nano EVER\n                bounce: false,\n                flags: 3,\n                payload: ''\n            }\n        },\n        is_internal:false,\n        signer:{type: 'Keys', keys: keypair}\n    })).body;\n\n    let deployAndTransferMsg =  await client.boc.encode_external_in_message({\n        dst: everWalletAddress,\n        init: stateInit,\n        body: body\n    });\n\n    let sendRequestResult = await client.processing.send_message({\n        message: deployAndTransferMsg.message,\n        send_events: false\n    });\n\n    let transaction = (await client.processing.wait_for_transaction({\n        abi: { type: 'Json', value: everWalletABI },\n        message: deployAndTransferMsg.message,\n        shard_block_id: sendRequestResult.shard_block_id,\n        send_events: false\n    })).transaction;\n\n\n    console.log('Contract deployed. Transaction hash', transaction.id)\n    assert.equal(transaction.status, 3)\n    assert.equal(transaction.status_name, \"finalized\")\n")),(0,o.kt)("h2",{id:"whats-next"},"What's next?"),(0,o.kt)("p",null,"Learn how to ",(0,o.kt)("a",{parentName:"p",href:"/build/development-guides/using-ever-sdk-and-devtools-to-work-with-venom/sending-transactions"},"send transactions")," from  wallet and to ",(0,o.kt)("a",{parentName:"p",href:"/build/development-guides/using-ever-sdk-and-devtools-to-work-with-venom/monitoring-transactions"},"monitor")," them."))}u.isMDXComponent=!0}}]);